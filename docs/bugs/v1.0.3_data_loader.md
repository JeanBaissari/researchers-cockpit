## Inconsistencies with Zipline-Reloaded Patterns

### 1\. Timezone Handling Issues

Your code has contradictory timezone logic:

* You localize to UTC, then convert to calendar timezone, then remove timezone info  
* Zipline-Reloaded expects timezone-naive dates in UTC for session boundaries, not calendar timezone  
* The normalize\_to\_calendar\_timezone approach conflicts with Zipline's internal UTC-based session handling

### 2\. Duplicate Docstrings

ingest\_bundle() has two docstrings \- this is a syntax issue where only the first is used.

### 3\. Calendar Registration Pattern

* You're using start\_session=first\_trading\_session from the calendar, but Zipline-Reloaded typically determines this from the ingested data itself  
* The start\_session in @register should match your actual data range, not calendar boundaries

### 4\. Bar Writer Signature

The data\_gen() yields (sid, bars\_df), which is correct, but Zipline-Reloaded's daily\_bar\_writer.write() expects the DataFrame index to be timezone-naive DatetimeIndex representing UTC midnight sessions \- your calendar timezone conversion may cause misalignment.

### 5\. Adjustment Writer

adjustment\_writer.write() with no arguments may fail in newer versions. Consider passing empty DataFrames explicitly:

### 6\. yfinance Index Assumption

Assuming yfinance returns UTC is incorrect \- it typically returns exchange-local timezone data, so your tz\_localize('UTC') assumption is wrong.